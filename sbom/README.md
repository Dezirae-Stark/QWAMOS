# QWAMOS Software Bill of Materials (SBOM)

This directory contains Software Bill of Materials (SBOM) files for QWAMOS, providing transparency about all software components, dependencies, and packages included in the project.

## What is an SBOM?

A Software Bill of Materials (SBOM) is a comprehensive inventory of all software components, dependencies, and metadata about those components. It's similar to a "nutrition label" for software, helping:

- üîç **Transparency**: Know exactly what's in your software
- üõ°Ô∏è **Security**: Identify vulnerable components quickly
- üìã **Compliance**: Meet regulatory and licensing requirements
- üîê **Supply Chain**: Track software provenance

## Directory Structure

```
sbom/
‚îú‚îÄ‚îÄ README.md               # This file
‚îú‚îÄ‚îÄ sbom-config.yml        # Syft configuration
‚îú‚îÄ‚îÄ sbom-ignore.txt        # Files to exclude from SBOM
‚îú‚îÄ‚îÄ builds/                # Version-specific SBOMs
‚îÇ   ‚îî‚îÄ‚îÄ v1.0.0/           # Example: SBOM for v1.0.0
‚îÇ       ‚îú‚îÄ‚îÄ sbom.json
‚îÇ       ‚îú‚îÄ‚îÄ sbom.xml
‚îÇ       ‚îú‚îÄ‚îÄ sbom.spdx.json
‚îÇ       ‚îú‚îÄ‚îÄ sbom.cyclonedx.json
‚îÇ       ‚îî‚îÄ‚îÄ sbom.txt
‚îî‚îÄ‚îÄ latest/                # Latest SBOM (symlink to newest)
    ‚îú‚îÄ‚îÄ sbom.json
    ‚îú‚îÄ‚îÄ sbom.xml
    ‚îú‚îÄ‚îÄ sbom.spdx.json
    ‚îú‚îÄ‚îÄ sbom.cyclonedx.json
    ‚îî‚îÄ‚îÄ sbom.txt
```

## SBOM Formats

QWAMOS SBOMs are generated in multiple formats for maximum compatibility:

| Format | File | Description | Use Case |
|--------|------|-------------|----------|
| **JSON** | `sbom.json` | Default Syft format | General use, machine-readable |
| **CycloneDX XML** | `sbom.xml` | CycloneDX 1.4 XML | Industry standard, tool integration |
| **SPDX JSON** | `sbom.spdx.json` | SPDX 2.3 JSON | Linux Foundation standard |
| **CycloneDX JSON** | `sbom.cyclonedx.json` | CycloneDX 1.4 JSON | Modern JSON format |
| **Text Table** | `sbom.txt` | Human-readable table | Manual review |

## Automated Generation

SBOMs are automatically generated by the [SBOM workflow](../.github/workflows/sbom.yml):

- **On push to master**: Generates and commits SBOM
- **On release creation**: Generates, signs, and uploads to release
- **Manual trigger**: On-demand SBOM generation

### Tools Used

- **[Syft](https://github.com/anchore/syft)**: SBOM generation tool by Anchore
- **[Grype](https://github.com/anchore/grype)**: Vulnerability scanner for SBOMs

## Usage

### Viewing SBOM

#### Human-Readable Format

```bash
# View latest SBOM as table
cat sbom/latest/sbom.txt

# View specific version
cat sbom/builds/v1.0.0/sbom.txt
```

#### Machine-Readable Format

```bash
# Pretty-print JSON
jq . sbom/latest/sbom.json

# Count packages
jq '.artifacts | length' sbom/latest/sbom.json

# List Python packages
jq '.artifacts[] | select(.type == "python") | .name' sbom/latest/sbom.json
```

### Verifying SBOM Signature

All release SBOMs are GPG-signed for authenticity:

```bash
# Download release SBOM and signature
gh release download v1.0.0 --pattern "sbom.*"

# Import GPG public key
gpg --import SIGNATURES_MANIFEST.txt

# Verify signature
gpg --verify sbom.json.asc sbom.json
```

### Scanning for Vulnerabilities

Use Grype to scan SBOM for known vulnerabilities:

```bash
# Install Grype
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin

# Scan SBOM
grype sbom:sbom/latest/sbom.json

# Scan with specific severity
grype sbom:sbom/latest/sbom.json --fail-on critical

# Output as JSON
grype sbom:sbom/latest/sbom.json --output json
```

### Converting SBOM Formats

```bash
# Install Syft
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin

# Convert JSON to CycloneDX XML
syft convert sbom/latest/sbom.json --output cyclonedx-xml --file sbom-cyclonedx.xml

# Convert to SPDX
syft convert sbom/latest/sbom.json --output spdx-json --file sbom-spdx.json
```

## What's Included

The SBOM catalogs:

### Package Managers
- **Python**: pip, requirements.txt, setup.py, poetry
- **Kotlin**: Gradle, Maven
- **JavaScript**: npm, yarn
- **Flutter/Dart**: pubspec.yaml
- **System**: APK (Alpine), DPKG (Debian), RPM

### Components
- Application source code
- Python dependencies
- Kotlin/Java libraries
- Docker base images
- System packages
- Build tools
- Development dependencies

### Metadata
- Package names and versions
- Licenses (SPDX identifiers)
- File hashes (SHA256)
- Package URLs (PURL)
- Relationships between components

## Compliance

QWAMOS SBOMs comply with:

- ‚úÖ **CycloneDX 1.4** specification
- ‚úÖ **SPDX 2.3** specification
- ‚úÖ **NTIA Minimum Elements for SBOM**:
  - Supplier name
  - Component name
  - Version
  - Dependency relationships
  - Author of SBOM data
  - Timestamp

## Security Use Cases

### Vulnerability Management

```bash
# Check for specific CVE
grype sbom:sbom/latest/sbom.json | grep CVE-2024-1234

# Check specific package
jq '.artifacts[] | select(.name == "cryptography")' sbom/latest/sbom.json
```

### License Compliance

```bash
# List all licenses
jq '.artifacts[].metadata.licenses[]?.value' sbom/latest/sbom.json | sort -u

# Find GPL licenses
jq '.artifacts[] | select(.metadata.licenses[]?.value | contains("GPL"))' sbom/latest/sbom.json
```

### Dependency Tracking

```bash
# List Python packages
jq '.artifacts[] | select(.type == "python") | {name, version}' sbom/latest/sbom.json

# Check for outdated packages
pip list --outdated
```

## Integration

### CI/CD Pipeline

SBOMs are automatically generated in CI/CD:

1. **Build**: Code is built and dependencies resolved
2. **Scan**: Syft scans repository for packages
3. **Generate**: SBOM created in multiple formats
4. **Sign**: GPG signature generated (releases only)
5. **Upload**: SBOM uploaded to release assets
6. **Commit**: SBOM committed to repository

### Vulnerability Scanning

```bash
# GitHub Actions integration
- name: Scan for vulnerabilities
  run: |
    grype sbom:sbom/latest/sbom.json --fail-on critical
```

## Configuration

### sbom-config.yml

Syft configuration file controlling:
- Catalogers to enable
- File exclusion patterns
- Output format options
- Metadata to include

### sbom-ignore.txt

Files and directories excluded from SBOM:
- Build artifacts
- Test fixtures
- IDE files
- Cache directories

See files for detailed configuration.

## Manual Generation

Generate SBOM manually:

```bash
# Install Syft
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin

# Generate SBOM
syft dir:. --config sbom/sbom-config.yml --output json --file sbom-manual.json

# Generate all formats
syft dir:. --config sbom/sbom-config.yml --output json --file sbom.json
syft dir:. --config sbom/sbom-config.yml --output spdx-json --file sbom.spdx.json
syft dir:. --config sbom/sbom-config.yml --output cyclonedx-json --file sbom.cyclonedx.json
```

## Troubleshooting

### Missing Packages

If packages are missing from SBOM:

1. Check `sbom-ignore.txt` for exclusion patterns
2. Verify package manager files are present (requirements.txt, build.gradle, etc.)
3. Enable additional catalogers in `sbom-config.yml`

### Signature Verification Fails

```bash
# Re-download SBOM and signature
gh release download v1.0.0 --pattern "sbom.*" --clobber

# Verify GPG key fingerprint
gpg --fingerprint "QWAMOS Release Signing Key"
```

### Format Conversion Issues

```bash
# Use Syft to validate SBOM
syft convert sbom.json --output json

# Check SBOM schema
jq '.schema.url' sbom.json
```

## Resources

- [NTIA SBOM Minimum Elements](https://www.ntia.gov/report/2021/minimum-elements-software-bill-materials-sbom)
- [CycloneDX Specification](https://cyclonedx.org/specification/overview/)
- [SPDX Specification](https://spdx.github.io/spdx-spec/)
- [Syft Documentation](https://github.com/anchore/syft)
- [Grype Documentation](https://github.com/anchore/grype)

## Contributing

When adding new dependencies:

1. Ensure package manager files are updated (requirements.txt, etc.)
2. SBOM will be auto-generated on next push
3. Review SBOM for completeness
4. Verify no unexpected dependencies

## License

See [LICENSE](../LICENSE) file.

---

**Last Updated**: Auto-generated on each release
**Maintained by**: QWAMOS Team
